# -*- coding: utf-8 -*-
"""
Created on Sat Jul 29 21:46:41 2023

@author: ryujih
"""
import numpy as np
def rad2bt(chn,rad):
    wn_a=[np.nan, np.nan, np.nan, np.nan, np.nan, np.nan, 
         2612.677373521110, 1617.609242531340, 1441.575428760170, 
         1365.249992024440, 1164.949392856340, 1039.960216776110, 
          966.153383926055,  891.713057301260,  810.609007871230, 
          752.792487755131]
    
    c0=[np.nan, np.nan, np.nan, np.nan, np.nan, np.nan,
        -0.447843939824124, -1.762794940111470, -0.334311414359106,
        -0.061312485969660, -0.141418528203155, -0.114017728158198,
        -0.142866448475177, -0.249111718496148, -0.458113885722738,
        -0.092338040428515 ]
    
    c1=[np.nan, np.nan, np.nan, np.nan, np.nan, np.nan,
        1.000655680903890, 1.004149105622780, 1.000973598744680,
        1.000190087229410, 1.000522329068850, 1.000473805854020,
        1.000640695720490, 1.001211668737560, 1.002455209755350,
        1.000525606454850 ]
    
    c2=[np.nan, np.nan, np.nan, np.nan, np.nan, np.nan,
        -6.338240899124480E-08, -9.833109143193850E-07, -4.946030702523040E-07,
        -1.058636567504990E-07, -3.628727607610900E-07, -3.749315099284030E-07,
        -5.504432949604980E-07, -1.131679640116650E-06, -2.530643147204760E-06,
        -5.627649979876500E-07]
    
    h = 6.6260695700E-34  # Planck constant   [Js]
    k = 1.3806488000E-23 # Boltzman constant  [J/K] 
    c = 2.9979245800E+08  # Speed of light    [m/s]
    
    wn=wn_a[chn]
    a1=h*c/k*(wn*100)
    a2=(2*h*c**2)*((wn*100)**3)
    a3=rad*1e-5
    Te=a1/(np.log(a2/a3+1))
    #Te=(h*c/k*(wn*100)) / (np.log( ((2*h*c**2)*((wn*100)**3))/(rad*1e-5 + 1) ))
    
    BT = c0[chn] + c1[chn]*Te + c2[chn]*(Te**2)
    return BT


